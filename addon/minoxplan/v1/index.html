<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Routine capillaire + Phases Kératine</title>
<style>
:root{
  --bg:#0b0f14; --panel:#121821; --text:#e6edf3; --muted:#8aa0b3;
  --line:#223041; --tag:#1b2431; --accent:#89d185; --warn:#ffd166;
}
*{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,#0a111a,#0b0f14 40%);color:var(--text);
  font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial,sans-serif}
.wrap{max-width:1100px;margin:auto;padding:24px}
h1{margin:0 0 10px;font-size:clamp(20px,3.6vw,28px)}
small.muted{color:var(--muted)}
.panel{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:12px}
.tag{display:inline-block;background:var(--tag);border:1px solid var(--line);padding:2px 8px;border-radius:999px;color:#cfe7ff;font-size:.8rem}

/* Tabs */
.tabs{margin-top:14px}
.tab-head{display:flex;gap:8px;flex-wrap:wrap}
.tab-head button{
  background:var(--tag);border:1px solid var(--line);color:var(--text);padding:8px 12px;border-radius:999px;cursor:pointer
}
.tab-head button[aria-selected="true"]{background:#1c2736}
.tab{display:none;margin-top:12px}
.tab.active{display:block}

/* Week grid (Semaine type) */
.grid{display:grid;gap:12px;grid-template-columns:140px 1fr 1fr 1.1fr}
.head,.cell{background:var(--panel);border:1px solid var(--line)}
.head{padding:10px 12px;font-weight:700;text-transform:uppercase;background:linear-gradient(180deg,#131b25,#101722)}
.row{display:contents}.cell{padding:12px}.note{color:var(--muted)}
.day{font-weight:700}.subtag{margin-top:6px}
.todo{display:grid;gap:10px}
.todo label{display:grid;grid-template-columns:auto 1fr;gap:8px;align-items:baseline;background:rgba(255,255,255,.02);padding:8px;border:1px dashed var(--line);border-radius:10px}
@media(max-width:870px){.grid{grid-template-columns:1fr}.head{display:none}}
/* Keratin phases */
.k-box{display:grid;gap:12px}
.k-top{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
input[type="date"]{background:var(--tag);border:1px solid var(--line);color:var(--text);padding:8px;border-radius:10px}
.k-dosage{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.pill{border:1px solid var(--line);background:#0f1722;padding:4px 10px;border-radius:999px}
.k-timeline{display:grid;gap:10px;margin-top:8px}
.k-phase{padding:10px;border:1px dashed var(--line);border-radius:10px}
.k-phase b{display:block;margin-bottom:6px}
.k-note{color:var(--muted);font-size:.95rem}
.actions{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
button{background:var(--tag);border:1px solid var(--line);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
button:hover{filter:brightness(1.07)}
</style>
</head>
<body>
<div class="wrap">
  <h1>🌕 Routine capillaire + Phases Kératine</h1>
  <small class="muted">
    Shampoings <b>lundi & jeudi</b> • Huile d’oignon <b>la veille et le jour même</b> •
    Minoxidil sur cuir chevelu <b>sec</b>. Les phases <b>kératine</b> sont des <u>dosages par périodes</u> (pas matin/soir).
  </small>

  <div class="tabs">
    <div class="tab-head">
      <button data-tab="week" aria-selected="true">🗓️ Semaine type</button>
      <button data-tab="attack">⚡ Kératine – Phase d’attaque</button>
      <button data-tab="maint">🌿 Kératine – Phase d’entretien</button>
    </div>

    <!-- Semaine type -->
    <section id="week" class="tab active">
      <div class="grid" id="weekGrid" aria-live="polite"></div>
    </section>

    <!-- Kératine – Attaque -->
    <section id="attack" class="tab">
      <div class="k-box">
        <div class="k-top">
          <span class="tag">Protocole d’attaque total : 45 jours</span>
          <div class="k-dosage">
            <label>Démarrer le protocole le :
              <input id="startAttack" type="date">
            </label>
            <span id="attackStatus" class="pill">Jour — Dosage —</span>
            <div class="actions">
              <button id="todayAttack">Mettre sur aujourd’hui</button>
              <button id="resetAttack">Réinitialiser</button>
            </div>
          </div>
        </div>
        <div class="k-timeline">
          <div class="k-phase">
            <b>Phase 1 (J1–J15) — 2 gélules / jour</b>
            <div class="k-note">Accent structure (kératine, zinc, vitamines B). Prendre avec un repas et un grand verre d’eau.</div>
          </div>
          <div class="k-phase">
            <b>Phase 2 (J16–J45) — 3 gélules / jour</b>
            <div class="k-note">Accent acides aminés soufrés (cystine, lysine, méthionine) + prêle. Hydratation régulière.</div>
          </div>
        </div>
        <div class="panel">
          <b>Rappel quotidien (à combiner avec la Semaine type) :</b>
          <ul>
            <li>Matin : 🧅 Jus d’oignon (≤1 h) → rinçage → séchage → 💧 Minoxidil 5 %.</li>
            <li>Soir : 🧅 Jus d’oignon (≤1 h) → rinçage → séchage → 💧 Minoxidil 5 %.</li>
            <li>Huile d’oignon : veille et jour de shampoing (lun/jeu), 2 h ou nuit sous charlotte.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Kératine – Entretien -->
    <section id="maint" class="tab">
      <div class="k-box">
        <div class="k-top">
          <span class="tag">Protocole d’entretien total : 75 jours</span>
          <div class="k-dosage">
            <label>Démarrer l’entretien le :
              <input id="startMaint" type="date">
            </label>
            <span id="maintStatus" class="pill">Jour — Dosage —</span>
            <div class="actions">
              <button id="todayMaint">Mettre sur aujourd’hui</button>
              <button id="resetMaint">Réinitialiser</button>
            </div>
          </div>
        </div>
        <div class="k-timeline">
          <div class="k-phase">
            <b>Phase 1 (J1–J30) — 1 gélule / jour</b>
            <div class="k-note">Stabilisation et entretien de la fibre.</div>
          </div>
          <div class="k-phase">
            <b>Phase 2 (J31–J75) — 2 gélules / jour</b>
            <div class="k-note">Consolidation et prévention de la chute.</div>
          </div>
        </div>
        <div class="panel">
          <b>Rappel quotidien (à combiner avec la Semaine type) :</b>
          <ul>
            <li>Conserve le même rituel oignon/minoxidil et les huiles la veille/jour de shampoing.</li>
          </ul>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
/* ---------- Onglets ---------- */
document.querySelectorAll('.tab-head button').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.tab-head button').forEach(b=>b.setAttribute('aria-selected','false'));
    btn.setAttribute('aria-selected','true');
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.getElementById(btn.dataset.tab).classList.add('active');
  });
});

/* ---------- Semaine type (oignon / minoxidil / huiles) ---------- */
const week = [
  { j:"Lundi", tag:"Jour de shampoing",
    m:["🧅 Jus d’oignon (1 h) → Rinçage doux → Séchage","💧 Minoxidil 5 %"],
    s:["🧴 Shampoing doux → Séchage","💧 Minoxidil 5 %"],
    note:"Cuir chevelu propre, prêt à absorber les actifs." },
  { j:"Mardi",
    m:["🧅 Jus d’oignon (1 h) → Rinçage → Séchage","💧 Minoxidil 5 %"],
    s:["🧅 Jus d’oignon (1 h) → Rinçage → Séchage","💧 Minoxidil 5 %"],
    note:"Routine classique — stimulation + hydratation interne." },
  { j:"Mercredi", tag:"Veille soin huile",
    m:["🧅 Jus d’oignon (1 h) → Rinçage → Séchage","💧 Minoxidil 5 %"],
    s:["💆‍♂️ Huile d’oignon maison (2 h ou nuit, charlotte)"],
    note:"Masse doucement le cuir chevelu pendant l’huile." },
  { j:"Jeudi", tag:"Jour de shampoing",
    m:["🧴 Rinçage huile → Shampoing doux → Séchage","💧 Minoxidil 5 %"],
    s:["💧 Minoxidil 5 %"],
    note:"Laisse bien respirer le cuir chevelu." },
  { j:"Vendredi",
    m:["🧅 Jus d’oignon (1 h) → Rinçage → Séchage","💧 Minoxidil 5 %"],
    s:["🧅 Jus d’oignon (1 h) → Rinçage → Séchage","💧 Minoxidil 5 %"],
    note:"Entretien & régénération." },
  { j:"Samedi", tag:"Veille soin huile",
    m:["🧅 Jus d’oignon (1 h) → Rinçage → Séchage","💧 Minoxidil 5 %"],
    s:["💆‍♂️ Huile d’oignon maison (2 h ou nuit)"],
    note:"Idéal avant repos dominical." },
  { j:"Dimanche",
    m:["🧴 Rinçage de l’huile (pas de shampoing si propre)"],
    s:["🧘 Routine libre / mini-massage"],
    note:"Récupération & visualisation de la repousse 🌱." }
];
const table = document.getElementById('weekGrid');
["Jour","Matin","Soir","Notes"].forEach(h=>{const d=document.createElement('div');d.className='head';d.textContent=h;table.appendChild(d);});
const KEY="cap-week-v2";
const saved=JSON.parse(localStorage.getItem(KEY)||"{}");
function chk(id, text){
  const L=document.createElement('label');
  const c=document.createElement('input'); c.type='checkbox'; c.checked=!!saved[id];
  c.addEventListener('change',()=>{saved[id]=c.checked;localStorage.setItem(KEY,JSON.stringify(saved));});
  const s=document.createElement('span'); s.textContent=text;
  L.appendChild(c); L.appendChild(s); return L;
}
week.forEach((d,di)=>{
  const cDay=document.createElement('div'); cDay.className='cell';
  cDay.innerHTML=`<div class="day">${d.j}${d.tag?`<div class="tag subtag">${d.tag}</div>`:''}</div>`;
  const cM=document.createElement('div'); cM.className='cell'; const tm=document.createElement('div'); tm.className='todo';
  d.m.forEach((t,ti)=>tm.appendChild(chk(`m-${di}-${ti}`,t))); cM.appendChild(tm);
  const cS=document.createElement('div'); cS.className='cell'; const ts=document.createElement('div'); ts.className='todo';
  d.s.forEach((t,ti)=>ts.appendChild(chk(`s-${di}-${ti}`,t))); cS.appendChild(ts);
  const cN=document.createElement('div'); cN.className='cell'; cN.innerHTML=`<div class="note">${d.note}</div>`;
  [cDay,cM,cS,cN].forEach(x=>table.appendChild(x));
});

/* ---------- Phases Kératine : calcul automatique du dosage du jour ---------- */
function fmt(d){return d.toISOString().slice(0,10);}
function daysSince(start){
  const s=new Date(start); const t=new Date(); s.setHours(0,0,0,0); t.setHours(0,0,0,0);
  return Math.floor((t - s)/86400000)+1; // J1 = jour du début
}
/* Attack: P1 J1-15 -> 2 gél/j ; P2 J16-45 -> 3 gél/j */
const AKEY="ker-attack-start";
const startAttack=document.getElementById('startAttack');
const attackStatus=document.getElementById('attackStatus');
startAttack.value=localStorage.getItem(AKEY)||"";
function updAttack(){
  const v=startAttack.value;
  if(!v){attackStatus.textContent="Jour — Dosage —";return;}
  localStorage.setItem(AKEY,v);
  const j=daysSince(v);
  let phase="", dose="";
  if(j<1){phase="(pas commencé)";dose="—";}
  else if(j<=15){phase=`Jour ${j} • Phase 1`;dose="2 gélules / jour";}
  else if(j<=45){phase=`Jour ${j} • Phase 2`;dose="3 gélules / jour";}
  else {phase=`Jour ${j} • Fin de l’attaque`;dose="—";}
  attackStatus.textContent = `${phase} · ${dose}`;
}
startAttack.addEventListener('change',updAttack);
document.getElementById('todayAttack').addEventListener('click',()=>{startAttack.value=fmt(new Date());updAttack();});
document.getElementById('resetAttack').addEventListener('click',()=>{localStorage.removeItem(AKEY);startAttack.value="";updAttack();});
updAttack();

/* Maintenance: P1 J1-30 -> 1 gél/j ; P2 J31-75 -> 2 gél/j */
const MKEY="ker-maint-start";
const startMaint=document.getElementById('startMaint');
const maintStatus=document.getElementById('maintStatus');
startMaint.value=localStorage.getItem(MKEY)||"";
function updMaint(){
  const v=startMaint.value;
  if(!v){maintStatus.textContent="Jour — Dosage —";return;}
  localStorage.setItem(MKEY,v);
  const j=daysSince(v);
  let phase="", dose="";
  if(j<1){phase="(pas commencé)";dose="—";}
  else if(j<=30){phase=`Jour ${j} • Phase 1`;dose="1 gélule / jour";}
  else if(j<=75){phase=`Jour ${j} • Phase 2`;dose="2 gélules / jour";}
  else {phase=`Jour ${j} • Fin de l’entretien`;dose="—";}
  maintStatus.textContent = `${phase} · ${dose}`;
}
startMaint.addEventListener('change',updMaint);
document.getElementById('todayMaint').addEventListener('click',()=>{startMaint.value=fmt(new Date());updMaint();});
document.getElementById('resetMaint').addEventListener('click',()=>{localStorage.removeItem(MKEY);startMaint.value="";updMaint();});
updMaint();
</script>
</body>
</html>
